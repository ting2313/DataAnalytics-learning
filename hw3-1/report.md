# Fundamentals of Data Analytics HW3-1
## 摘要
　　預測 ![S&P 500](https://www.sharecast.com/index/SP_500/prices/download) 股價趨勢。
## 環境
### 撰寫環境
* Python 3.7
* Ubuntu 16.04
### 使用套件
* 和課堂教材無異，詳見requirements.txt
## 分析方式與參數
　　這次套用sklearn之中下列三種模型來分析：
### 線性迴歸
* 模型名稱：LinearRegression
* 使用參數：模型內全部使用default，輸出結果為0~1之間的整數。以ROC曲線的概念取0.54為判斷漲跌的標準值。
### 類神經網路
* 模型名稱：MLPClassifier
* 使用參數：

    參數名稱 | 數值 | 意義  
    ---- | --- | --- 
    solver | adam | 優化參數使用的演算法
    random_state | 1010 | 用於重現結果
    max_iter | 1000 | 最大迭代次數

    * solver如果不考慮需要更仔細調校的sgd，有adam和lbfgs可選，前者適用於較大型的資料，後者在較小的資料集可以快速收斂。
    * max_iter為最大迭代次數，倘若到達此次數仍沒有收斂，則會直接中止。

### 隨機森林
* 模型名稱：RandomForestClassifier
* 使用參數：
    * random_state : 使得實驗結果可以被重現
    * n_estimator : 建立樹的數量，理應越大越好，多次測試後發現500後對結果沒有顯著的優化，因此選500

## Discussion
### How did you preprocess this dataset?
1. 由於作業要求要使用分類器來做漲跌的預測，因此需要先將參數轉換成類別。我將漲換成1，跌換成0。
2. 為了增加精確度，我取了前四天作為第五天的預測基準。因此要將前四天之間各項數值的漲跌處理成一組輸入值。第四天收盤與第五天收盤時的差值為輸出值。
### Which classifier reaches the highest classification accuracy in this dataset? Why?
以同樣的input輸入，輸出結果如下：

模型 | Recall | Position | Accuracy 
---- | --- | --- | ---
線性迴歸 | 0.63 | 0.60 | 0.56
類神經網路 | 0.78 | 0.60 | 0.59
隨機森林 | 0.75 | 0.59 | 0.57

Accuracy為類神經網路略高，Position的部份沒有太大的差異，Recall為類神經網路最高。

推測線性迴歸最差是因為容易受到偏差值影響，而這次股價的趨勢為整體看漲但偶爾下跌，使得訓練資料中的下跌影響了漲幅的預測。
而類神經網路在三項數值皆為最優，我想是因為類神經網路在演算法上使用了最多的資源來運算輸入與輸出之間的關聯，同時在迭代的過程中減少被下跌的資料所影響的比例。

### Can this result remain if the dataset is different ?
　　以判斷精準度來說，我認為不一定。因為我們手上僅有每日的漲跌趨勢，然而影響股票的因素不僅於此，還包含了現實中的消費信心指數或是對公司的信任度，並不能僅僅以趨勢來判斷。舉例來說，在這份資料中下跌的狀況就都與前面的漲幅無關。
　　如果套用在與這次一樣，漲跌整體趨勢穩定（穩定上漲或穩定下跌），只有偶爾出現非趨勢的下跌或上漲，那使用這次的分類結果就會得到類似的結果；但如果是大起大落的股票資料，那預測的結果就很有可能會比這次糟糕許多。

### How did you improve your classifiers ?
1. 最一開始我將最高價/最低價/開盤價/收盤價/成交量都加入了參數，結果使得訓練資料有逼近90%的準確率，對測試資料卻只有50%。我想是overfitting了，所以就把理論尚無關的最高最低價移除，測試資料的準確度也隨之上升。
2. 線性迴歸的判斷上，原先是直觀的使用0.5作為漲跌的標準，使得recall有0.92，但Position只有0.54。看起來是標準設過低，導致較為容易判斷為Positive，為了平衡做了測試，將標準上修為0.54。
3. 類神經網路一開始參數solver使用了"lbfgs"，結果出現無法收斂的問題，也就沒有快速收斂的笑過，因此改用適合大量參數的"adam"。

## 可以努力的方向
1. 最佳化輸入的參數：
    可以再針對結果進行最佳化，找到最適合的輸入參數。例如要往前看幾天以及哪些是較為重要的因子。
2. 類神經網路參數調校：
    理論上sgd在仔細調校後可以獲得更好的結果，之後可以再研究其他參數的使用方式。
3. 找到相關指標：
    如同前面所述，除了價格外還有很多影響股價的因素，希望能找到其他和股價漲跌更直接相關的參數來增加模型的準確度。